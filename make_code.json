{"InfintyMake.Solution":{"Requires":[],"Code":"function Get-SolutionFormFile([string]$SolutionFilePath) {\r\n    $Solution = @{}\r\n    function Set-SolutionName([string]$Name) {\r\n        $Solution['Name'] = $Name\r\n    }\r\n\r\n    function Add-Option([string]$Name, [scriptblock]$Code) {\r\n        $Option = @{}\r\n        \r\n        function Set-Default($Value) {\r\n            $Option['Default'] = $Value\r\n            $Option['Value'] = $Value\r\n        }\r\n\r\n        Invoke-Command $Code\r\n\r\n        if (-not $Solution.ContainsKey('Options')) {\r\n            $Solution['Options'] = @{}\r\n        }\r\n        $Solution['Options'][$Name] = $Option\r\n    }\r\n\r\n    function Get-ToolChain([string]$Name) {\r\n        \r\n    }\r\n\r\n    function Set-Option([string]$Name, $Value) {\r\n        if (-not $Solution['Options'].ContainsKey($Name)) {\r\n            Write-Error \"CanNotFindOption<$Name>\"\r\n            return\r\n        }\r\n        $Solution['Options'][$Name]['Value'] = $Value\r\n    }\r\n\r\n    function Get-Option([string]$Name) {\r\n        if (-not $Solution['Options'].ContainsKey($Name)) {\r\n            Write-Error \"CanNotFindOption<$Name>\"\r\n            return\r\n        }\r\n        return $Solution['Options'][$Name]['Value']\r\n    }\r\n\r\n\r\n    function Add-Project([string]$Name, [scriptblock]$Code) {\r\n        $Project = @{\r\n            'Name' = $Name\r\n        }\r\n\r\n        function Set-ToolChain([string]$ToolChain) {\r\n            $Project['ToolChain'] = $ToolChain\r\n        }\r\n        function Set-Langauges([string[]]$Languages) {\r\n            $Project['Languages'] = $Languages\r\n        }\r\n        function Set-Kind([string]$Kind) {\r\n            $Project['Kind'] = $Kind\r\n        }\r\n        function Set-Arch([string]$Arch) {\r\n            $Project['Arch'] = $Arch\r\n        }\r\n        function Add-Requires([string[]]$Requires) {\r\n            if (-not $Project.ContainsKey('Requires')) {\r\n                $Project['Requires'] = @()\r\n            }\r\n            $Project['Requires'] += $Requires\r\n        }\r\n        function Add-SourceFile([string[]]$SourceFiles) {\r\n            if ($null -eq $Project['SourceFiles']) {\r\n                $Project['SourceFiles'] = $SourceFiles\r\n            }\r\n            else {\r\n                $Project['SourceFiles'] += $SourceFiles\r\n            }\r\n        }\r\n\r\n        Invoke-Command $Code\r\n\r\n        if (-not $Solution.ContainsKey('Projects')) {\r\n            $Solution['Projects'] = @()\r\n        }\r\n        $Solution['Projects'] += $Project\r\n    }\r\n\r\n    . $SolutionFilePath\r\n\r\n    return $Solution\r\n}\r\n\r\nWrite-Host (Get-SolutionFormFile '.\\test_solution.ps1' | ConvertTo-Json -Depth 10)\r\n"},"InfintyMake.Main":{"Requires":["InfintyMake.Solution"],"Code":"\r\nfunction Invoke-Main([string[]]$ArgumentList) {\r\n    Write-Host $ArgumentList\r\n    return 0\r\n}\r\n"}}
